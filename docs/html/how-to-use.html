<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tutorial &mdash; Plato - Strategic Classification Made Practical 0.9 documentation</title><link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "tex2jax_ignore|mathjax_ignore|document", "processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Examples" href="examples.html" />
    <link rel="prev" title="Welcome to Plato - Strategic Classification Made Practical’s documentation!" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> Plato - Strategic Classification Made Practical
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#required-imports">Required Imports</a></li>
<li class="toctree-l2"><a class="reference internal" href="#data-prepration">Data Prepration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#out-of-the-box-strategic-classification">Out of the box Strategic Classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="#modifiable-strategic-classification">Modifiable Strategic Classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="#add-ons">Add ons</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="code.html">Code</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Plato - Strategic Classification Made Practical</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Tutorial</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/how-to-use.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="tutorial">
<h1>Tutorial<a class="headerlink" href="#tutorial" title="Permalink to this headline">¶</a></h1>
<p>Plato is built to serve users in multiple expertise levels, from using the default parameters up to utilizing the modular design and taking only parts while overriding the others.
Here are some instractions and examples on how to use the package. Full usage examples are listed under the <em>“examples”</em> section, while the full code is avilable on GitHub and documented on the <em>“code”</em> section.</p>
<div class="section" id="required-imports">
<h2>Required Imports<a class="headerlink" href="#required-imports" title="Permalink to this headline">¶</a></h2>
<p>Strategic classification has two parts, and accordingly Plato is based on two main frameworks:</p>
<ul class="simple">
<li><p><strong>Classification logic</strong> is built upon PyTorch framework, so <cite>import torch</cite> will be required</p></li>
<li><p><strong>Strategic behavior</strong> by the user is modeled through a convex problem and solved using CVXPY. While you can avoid using CVXPY framework utilizing our pre-built cost functions, you will need to <cite>import cvxpy</cite>  if you wish to create your own cost function.</p></li>
</ul>
<p>Furthermore, Plato saves model and results into your enviorment, for that <cite>import os</cite> is used.
To summrize, the import and defention section would look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">cvxpy</span> <span class="k">as</span> <span class="nn">cp</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">from</span> <span class="nn">lib.StrategicModel</span> <span class="kn">import</span> <span class="n">StrategicModel</span>

<span class="n">PATH</span> <span class="o">=</span> <span class="s2">&quot;./Results/vanilla_vs_hardt_orig&quot;</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">PATH</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">PATH</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="data-prepration">
<h2>Data Prepration<a class="headerlink" href="#data-prepration" title="Permalink to this headline">¶</a></h2>
<p>There is no spiceal data prepration required for Plato. The framework expects to recive the data and the labels in two different tensors.
Furthermore, validation data can be sent together with training data to enjoy smart saving and quick stop mechanisem.</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>Smart saving</strong> will save the epoch’s learning only if the accuracy on validation increased.</p></li>
<li><p><strong>Quick stop</strong> will stop the model from learning if it hasn’t got any better in 4 consecutive epochs.</p></li>
</ul>
</div></blockquote>
<p><a href="#id1"><span class="problematic" id="id2">|:Warning:|</span></a> While not a classic data preparation, please notice the cost function is sensitive to scale. You can either scale the params or scale the cost function using the <cite>scale</cite> param.</p>
</div>
<div class="section" id="out-of-the-box-strategic-classification">
<h2>Out of the box Strategic Classification<a class="headerlink" href="#out-of-the-box-strategic-classification" title="Permalink to this headline">¶</a></h2>
<p>If you wish to use Plato in the most basic form presented in the paper, Plato has all the parameters pre-defined and ready to run out of the box.
You will need to define a Plato model, and then fit model by providing the data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">plato_model</span> <span class="o">=</span> <span class="n">StrategicModel</span><span class="p">(</span><span class="n">x_dim</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">)</span>
<span class="n">plato_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Xval</span><span class="p">,</span> <span class="n">Yval</span><span class="p">)</span>
</pre></div>
</div>
<p><cite>x_dim</cite> is the dimension of your data, <cite>batch_size</cite> is the batch sizes you need for training.</p>
</div>
<div class="section" id="modifiable-strategic-classification">
<h2>Modifiable Strategic Classification<a class="headerlink" href="#modifiable-strategic-classification" title="Permalink to this headline">¶</a></h2>
<p>The power of Plato is that it is highly modifable Strategic Classification with planty of pre-built options.
For example, if you wish to look for a proper scale to a quadratic cost function, and control the learning mechanism optimizer and step size, your code can look like the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">scales</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="k">for</span> <span class="n">scale</span> <span class="ow">in</span> <span class="n">scales</span><span class="p">:</span>
        <span class="n">plato_model</span> <span class="o">=</span> <span class="n">StrategicModel</span><span class="p">(</span><span class="n">x_dim</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">,</span> <span class="n">cost_fn</span><span class="o">=</span><span class="s2">&quot;quad&quot;</span><span class="p">,</span> <span class="n">cost_const_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="n">scale</span><span class="p">})</span>
        <span class="n">plato_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Xval</span><span class="p">,</span> <span class="n">Yval</span><span class="p">,</span> <span class="n">opt_class</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">,</span> <span class="n">opt_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;lr&quot;</span><span class="p">:</span> <span class="mf">1e-1</span><span class="p">},</span>
                        <span class="n">epochs</span><span class="o">=</span><span class="n">epochs</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="s2">&quot;epochs&quot;</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">PATH</span><span class="p">,</span> <span class="n">model_name</span><span class="o">=</span><span class="n">model_name</span><span class="p">)</span>
</pre></div>
</div>
<p>You can visit the <a class="reference internal" href="code.html"><span class="doc">Code</span></a> section to see all the parameters and their default definitions.</p>
</div>
<div class="section" id="add-ons">
<h2>Add ons<a class="headerlink" href="#add-ons" title="Permalink to this headline">¶</a></h2>
<p>While Plato is highly modifiable, in its heart there is a linear classifier, and you would maybe want to have another model there or to have the linear model do something beyond the suggested.
Plato framework is built in a modular way and with lots of abstraction, so if you wish to use another model, you can easily takes pieces.
⚠️ To ensure the response mapper solves a concave problem, the classification model must be linear on the gameable features.</p>
<p>To see an example, please visit at <a class="reference internal" href="code.html"><span class="doc">Code</span></a> the flexibility section, in which we demonstrate how we override the basic model to create a model who is not passively classifying but affects the costs.</p>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Welcome to Plato - Strategic Classification Made Practical’s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="examples.html" class="btn btn-neutral float-right" title="Examples" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Sagi Levanon, Nir Rosenfeld, Yehonatan Assaf, Michael Makhlevich.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>